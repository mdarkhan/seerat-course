<!DOCTYPE html>
<html lang="bn" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>মাসউদ আলিমী - সীরাত কোর্স</title>
    
    <!-- Google Fonts: Hind Siliguri -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Hind Siliguri"', 'ui-sans-serif', 'system-ui', 'sans-serif', "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"],
                    },
                    colors: {
                        emerald: {
                            50: '#ecfdf5', 100: '#d1fae5', 200: '#a7f3d0', 300: '#6ee7b7', 
                            400: '#34d399', 500: '#10b981', 600: '#059669', 700: '#047857', 
                            800: '#065f46', 900: '#064e3b', 950: '#022c22',
                        }
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'glow': '0 0 15px rgba(16, 185, 129, 0.3)'
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Hind Siliguri', sans-serif; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fade-in 0.4s ease-out forwards; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-33.3333%); } }
        .animate-marquee { display: flex; width: max-content; animation: marquee 12s linear infinite; }
        .animate-marquee:hover { animation-play-state: paused; }
        @keyframes pop { 0% { transform: scale(0.95); opacity: 0.5; } 100% { transform: scale(1); opacity: 1; } }
        .animate-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 transition-colors duration-300 min-h-screen flex flex-col antialiased">

    <div id="app" class="contents"></div>

    <script>
        // --- DATA & CONFIG ---
        const COURSE_DATA = [
            {
                id: 2,
                date: "2026-01-02",
                duration: "2 hr 15 min",
                category: "seerat",
                driveLink: "https://drive.google.com/file/d/10ec8WS0aDemwlLFaavuA1_fTyV1m6x3j/view?usp=sharing",
                content: {
                    title: "সীরাত-০১ঃ সীরাত পাঠের গুরুত্ব",
                    description: "আমাদের দৈনন্দিন জীবন ও আখিরাতে সীরাত পাঠের গুরুত্ব ও পদ্ধতি সম্পর্কে আলোচনা করা হয়েছে।",
                    syllabus: `দারসের আলোচনা আর "সীরাত পাঠ" বইয়ের ১৫ থেকে ৪৫ পৃষ্ঠার মধ্যে পরবর্তী পরীক্ষা হবে ইনশা আল্লাহু তা'আলা।`,
                    resources: [{ label: "বইঃ সীরাত পাঠ - গুরুত্ব, পদ্ধতি ও প্রায়োগিক রুপ<br />(লেখকঃ মাওলানা খালিদ সাইফুল্লাহ রহমানী)", url: "#" }]
                },
                quiz: []
            },
            {
                id: 4,
                date: "2026-01-09",
                duration: "1 hr 55 min",
                category: "seerat",
                driveLink: "https://drive.google.com/file/d/1ZDWo-M7Ai0EFPyO2sF19OV7X38yDWDOk/view?usp=sharing",
                content: {
                    title: "সীরাত-০২ঃ সীরাত সংরক্ষণ ও আরব জাতির ইতিহাস",
                    description: "সীরাত সংরক্ষণের বৈজ্ঞানিক পদ্ধতি, আরবের ভৌগোলিক গুরুত্ব এবং ইব্রাহিম (আ.) ও ইসমাইল (আ.)-এর ইতিহাস।",
                    summary: [
                        "সীরাত সংরক্ষণের ইতিহাস ও নির্ভরযোগ্যতা",
                        "আরব উপদ্বীপের ভৌগোলিক ও কৌশলগত গুরুত্ব",
                        "আরব জাতির শ্রেণিবিভাগ",
                        "ইব্রাহিম (আ.) ও ইসমাইল (আ.)-এর মক্কায় আগমন",
                        "আরবে মূর্তিপূজার সূচনা"
                    ],
                    syllabus: `পরীক্ষা দারস ও "সীরাতে খাতামুল আম্বিয়া" বইয়ের ২১ থেকে ২৬ নম্বর পৃষ্ঠা পর্যন্ত এর উপর হবে।`,
                    resources: [{ label: 'বইঃ "সীরাতে খাতামুল আম্বিয়া"<br />(লেখকঃ মুফতী মুহাম্মদ শফী)', url: "#" }]
                },
                quiz: []
            },
            {
                id: 5,
                date: "2026-01-16",
                duration: "2 hr 12 min",
                category: "seerat",
                driveLink: "https://drive.google.com/file/d/1kZ_1tZbT5hPbaCVFbEmeX2TbGRcE_zy-/view?usp=sharing",
                content: {
                    title: "সীরাত-০৩",
                    description: "এই ক্লাসের বিস্তারিত তথ্য ও কুইজ শীঘ্রই আপডেট করা হবে।",
                    summary: "এই ক্লাসের বিস্তারিত তথ্য ও কুইজ শীঘ্রই আপডেট করা হবে।",
                    syllabus: `পরীক্ষা দারস ও "সীরাতে খাতামুল আম্বিয়া" বইয়ের ২৬ থেকে ৪২ নম্বর পৃষ্ঠা পর্যন্ত এর উপর হবে।`,
                    resources: [{ label: 'বইঃ "সীরাতে খাতামুল আম্বিয়া"<br />(লেখকঃ মুফতী মুহাম্মদ শফী)', url: "#" }]
                },
                quiz: [
                    {question: "বিবি হালিমার বর্ণনা অনুযায়ী, শিশু মুহাম্মাদ (সা.)-এর জবান থেকে উচ্চারিত সর্বপ্রথম কথাগুলো কী ছিল?", options: ["লা ইলাহা ইল্লাল্লাহু মুহাম্মাদুর রাসুলুল্লাহ", "আল্লাহু আকবার কাবিরা ওয়াল হামদুলিল্লাহি কাসিরা", "সুবহানাল্লাহি ওয়া বিহামদিহি সুবহানাল্লাহিল আজিম", "আলহামদুলিল্লাহি রাব্বিল আলামিন আররাহমানির রাহিম"], correctIndex: 1, note: "নবিজির সর্বপ্রথম কথা ছিল: 'আল্লাহু আকবার কাবিরা ওয়াল হামদুলিল্লাহি কাসিরা ওয়া সুবহানাল্লাহি বুকরাতাও ওয়া আসিলা'। সূত্র: পৃষ্ঠা ২৬।"},
                    {question: "দুধমাতা হালিমার ঘরে অবস্থানকালে শিশু নবি (সা.)-এর দুধভাইয়ের নাম কী ছিল?", options: ["আব্দুল্লাহ", "হামজা", "আব্বাস", "উবাইদ"], correctIndex: 0, note: "নবিজি যখন দুধভাই আব্দুল্লাহর সাথে বকরি চরাতে যেতেন, তখন বক্ষবিদীর্ণকরণ বা 'শাক্কুস সদর'-এর ঘটনা ঘটে। সূত্র: পৃষ্ঠা ২৬।"},
                    {question: "নবিজির শিশুকালে 'শাক্কুস সদর' বা বক্ষবিদীর্ণকরণ ঘটনার সময় আব্দুল্লাহর বর্ণনামতে আগন্তুক দুই ব্যক্তির বৈশিষ্ট্য কী ছিল?", options: ["তাঁরা সাদা পোশাক পরিহিত ছিলেন", "তাঁদের হাতে সোনার তস্তরি ছিল", "তাঁরা কুরাইশ ভাইকে শুইয়ে বুক চিরে ফেলেছিলেন", "তাঁরা কালো ঘোড়ায় চড়ে এসেছিলেন"], correctIndices: [0, 2], note: "আব্দুল্লাহ এসে বাবাকে বলেন, 'দুজন সাদা পোশাকধারী লোক এসে আমার কুরাইশি ভাইকে শুইয়ে দিয়েছে। তার বুক চিরে ফেলেছে'। সূত্র: পৃষ্ঠা ২৬।"},
                    {question: "নবিজি (সা.)-কে কেন শিশুকালে মক্কায় তাঁর মায়ের কাছে ফেরত পাঠানো যাচ্ছিল না?", options: ["কুরাইশদের মধ্যে যুদ্ধ চলছিল", "মক্কায় তখন প্লেগের মহামারি ছড়িয়ে পড়েছিল", "হালিমার পরিবারের আর্থিক অনটন ছিল", "নবিজি অসুস্থ হয়ে পড়েছিলেন"], correctIndex: 1, note: "ঠিক সে সময় মক্কায় প্লেগের মহামারি ছড়িয়ে পড়েছিল। সেই বাহানায় হালিমা নবিজিকে আবার ফিরিয়ে আনেন। সূত্র: পৃষ্ঠা ২৬।"},
                    {question: "নবিজি (সা.)-এর জননী হযরত আমিনা কোন স্থানে ইন্তেকাল করেন?", options: ["মদিনা", "তায়েফ", "আবওয়া", "হুদাইবিয়া"], correctIndex: 2, note: "মদিনা থেকে মক্কা ফেরার পথে 'আবওয়া' নামক স্থানে শ্রদ্ধেয় জননী দুনিয়া থেকে বিদায় নেন। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "মায়ের ইন্তেকালের সময় নবিজি (সা.)-এর বয়স কত ছিল?", options: ["চার বছর", "পাঁচ বছর", "ছয় বছর", "আট বছর"], correctIndex: 2, note: "টেক্সট অনুযায়ী, 'শৈশবকাল। ছয় বছর বয়স। পিতার ছায়া তো আগেই দূর হয়ে গিয়েছিল। এখন স্নেহময়ী জননীর মমতার আশ্রয়ও শেষ হয়ে গেল।' সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "দাদা আব্দুল মুত্তালিবের ইন্তেকালের সময় নবিজি (সা.)-এর সঠিক বয়স কত ছিল?", options: ["আট বছর দুই মাস দশ দিন", "আট বছর পাঁচ মাস তিন দিন", "নয় বছর পূর্ণ হওয়ার পথে", "সাত বছর এগারো মাস"], correctIndex: 0, note: "নবি (সা.)-এর বয়স যখন আট বছর দুই মাস দশ দিন, তখন আব্দুল মুত্তালিবও দুনিয়ার সফর সমাপ্ত করেন। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "চাচা আবু তালিবের সাথে নবিজি (সা.)-এর প্রথম শাম সফরের সময় তাঁর বয়স কত ছিল?", options: ["দশ বছর", "বারো বছর দুই মাস", "চৌদ্দ বছর", "পনেরো বছর"], correctIndex: 1, note: "যখন নবি (সা.)-এর বয়স বারো বছর দুই মাস হয়, তখন আবু তালিব ব্যবসা-বাণিজ্যের উদ্দেশ্যে শামদেশে যাওয়ার ইচ্ছা করেন। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "প্রথম শাম সফরের সময় কোন স্থানে বুহাইরা রাহিবের সাথে কাফেলার সাক্ষাৎ হয়?", options: ["বসরা", "দামেস্ক", "তাইমা", "ইয়ামেন"], correctIndex: 2, note: "পথিমধ্যে তাঁরা 'তাইমা' নামক স্থানে যাত্রাবিরতি করেন এবং সেখানেই বুহাইরা রাহিবের সাথে সাক্ষাৎ হয়। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "পাদরি বুহাইরা কোন ধর্মগ্রন্থের পণ্ডিত ছিলেন?", options: ["ইনজিল", "যাবুর", "তাওরাত", "বেদ"], correctIndex: 2, note: "বুহাইরা পাদরি তাওরাতের পণ্ডিত ছিলেন। আর তাওরাতে রাসুল (সা.)-এর সমস্ত বিবরণ সুস্পষ্টভাবে উল্লেখ ছিল। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "বুহাইরা রাহিব নবিজি (সা.)-কে চিনে ফেলার পর আবু তালিবকে কী সতর্কবার্তা দিয়েছিলেন?", options: ["রোমানরা তাঁকে হত্যা করতে পারে", "ইহুদিরা তাঁকে হত্যা করতে পারে", "পারসিকরা তাঁকে বন্দি করতে পারে", "খ্রিস্টানরা তাঁকে জাদুকর ভাবতে পারে"], correctIndex: 1, note: "বুহাইরা বলেন, 'যদি আপনি এই ছেলেকে শামে নিয়ে যান, তবে ইহুদিরা তাঁকে হত্যা করবে। কারণ এই ছেলেটি আল্লাহর নবি...'। সূত্র: পৃষ্ঠা ২৮।"},
                    {question: "নবিজি (সা.) কোন উপাধিতে মক্কাবাসীর কাছে প্রসিদ্ধ ছিলেন?", options: ["আস-সাদিক", "আল-আমিন", "আল-ফারুক", "আল-মুস্তফা"], correctIndex: 1, note: "তিনি 'আল-আমিন' বা বিশ্বস্ত উপাধিতে প্রসিদ্ধ ছিলেন। তাঁর এই সুনাম ও খ্যাতি খাদিজা (রা.)-এর কাছেও অজানা ছিল না। সূত্র: পৃষ্ঠা ২৯।"},
                    {question: "হযরত খাদিজা (রা.)-এর বাণিজ্যে সাহায্য করার জন্য নবিজির সাথে কাকে পাঠানো হয়েছিল?", options: ["জায়েদ", "মাইসারা", "উম্মে আয়মান", "আব্দুল্লাহ"], correctIndex: 1, note: "খাদিজা (রা.)-এর দাস মাইসারাকে সঙ্গে নিয়ে ১৬ যিলহজ সফরের জন্য রওনা হন। সূত্র: পৃষ্ঠা ২৯।"},
                    {question: "দ্বিতীয়বার শাম সফরের সময় নবিজি (সা.)-এর সাথে কোন পাদরি বা রাহিবের সাক্ষাৎ হয়?", options: ["বুহাইরা", "নাসতুরা", "ওয়ারাকা", "জারজিস"], correctIndex: 1, note: "শামের পথে এক স্থানে অবস্থানকালে নবি (সা.)-এর সাক্ষাৎ হয় 'নাসতুরা' নামক একজন রাহিবের সঙ্গে। সূত্র: পৃষ্ঠা ২৯।"},
                    {question: "পাদরি নাসতুরা নবিজি (সা.) সম্পর্কে কী মন্তব্য করেছিলেন?", options: ["ইনি আরবের শেষ রাজা হবেন", "ইনি একজন মহান যোদ্ধা হবেন", "ইনি একজন ধনী বণিক হবেন", "ইনি মক্কার নেতা হবেন"], correctIndex: 3, note: "সঠিক উত্তর: তিনি বলেছিলেন 'এই ব্যক্তি অবশ্যই নবি হবেন'। অপশনগুলোতে সঠিক উত্তর নেই। সূত্র: পৃষ্ঠা ৩০।"},
                    {question: "হযরত খাদিজা (রা.)-এর সাথে বিবাহের সময় নবিজির বয়স কত ছিল?", options: ["২০ বছর", "২৫ বছর", "৩০ বছর", "৩৫ বছর"], correctIndex: 1, note: "বিবাহের সময় রাসুল (সা.)-এর বয়স ছিল ২৫ বছর। সূত্র: পৃষ্ঠা ৩০।"},
                    {question: "হযরত খাদিজা (রা.)-এর সাথে বিবাহের সময় তাঁর বয়স সম্পর্কে কোন কোন মত পাওয়া যায়?", options: ["৪০ বছর", "৪৫ বছর", "২৮ বছর", "২৫ বছর"], correctIndices: [0, 1], note: "খাদিজা (রা.)-এর বয়স সে-সময় ছিল ৪০ বছর। কিছু বর্ণনায় ৪৫ বছর উল্লেখ করা হয়েছে। সূত্র: পৃষ্ঠা ৩০।"},
                    {question: "নবিজি ও খাদিজার বিবাহ অনুষ্ঠানে কে 'খুতবা' বা ভাষণ প্রদান করেছিলেন?", options: ["আবু বকর (রা.)", "হামজা (রা.)", "আবু তালিব", "ওয়ারাকা ইবনে নাওফেল"], correctIndex: 2, note: "বিবাহের অনুষ্ঠানে আবু তালিব, বনি হাশিম এবং মুদার গোত্রের নেতৃস্থানীয় ব্যক্তিবর্গ উপস্থিত ছিলেন। আবু তালিব খুতবা প্রদান করেন। সূত্র: পৃষ্ঠা ৩০।"},
                    {question: "হযরত খাদিজার মোহরানার অর্থ কীভাবে পরিশোধ করার কথা খুতবায় উল্লেখ ছিল?", options: ["সম্পূর্ণ নগদ", "সম্পূর্ণ বাকি", "অগ্রিম (মু'য়াজ্জাল) ও বাকি (মুয়াজ্জাল) উভয় অংশে", "পশু সম্পদের মাধ্যমে"], correctIndex: 2, note: "খুতবায় বলা হয়: 'তাঁর সম্পূর্ণ মোহরানার অগ্রিম (মু'য়াজ্জাল) ও বাকি (মুয়াজ্জাল) উভয় অংশ—আমার সম্পদ থেকে প্রদান করা হবে।' সূত্র: পৃষ্ঠা ৩০।"},
                    {question: "হযরত খাদিজা (রা.)-এর গর্ভ থেকে নবিজির কতজন সন্তান জন্মগ্রহণ করেন?", options: ["৩ জন", "৪ জন", "৬ জন", "৭ জন"], correctIndex: 2, note: "হযরত খাদিজা (রা.)-এর গর্ভ থেকে রাসুল (সা.)-এর দুই পুত্র এবং চার কন্যার জন্ম হয়। মোট ৬ জন। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "নবিজির কোন পুত্রের নামানুসারে তাঁর উপনাম 'আবুল কাসিম' হয়?", options: ["আব্দুল্লাহ", "তানিজ", "কাসিম", "ইবরাহীম"], correctIndex: 2, note: "কাসিমের নামেই রাসুল (সা.)-এর উপনাম 'আবুল কাসিম' প্রসিদ্ধি লাভ করে। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "নবিজির পুত্র 'তাহির'-এর অপর নাম কী ছিল বলে উল্লেখ আছে?", options: ["ইবরাহীম", "আব্দুল্লাহ", "তাইয়্যেব", "মুসআব"], correctIndex: 1, note: "তাহির সম্পর্কে বলা হয়, তাঁর নাম ছিল আব্দুল্লাহ। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "নবিজির তৃতীয় পুত্র ইবরাহীম কার গর্ভে জন্মগ্রহণ করেছিলেন?", options: ["খাদিজা (রা.)", "আয়িশা (রা.)", "মারিয়া কিবতিয়া (রা.)", "সাওদা (রা.)"], correctIndex: 2, note: "নবি (সা.)-এর তৃতীয় পুত্র ইবরাহীম (রা.)-এর জন্ম হয়েছিল হযরত মারিয়া কিবতিয়া (রা.)-এর গর্ভে। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "উম্মতের ঐকমত্যে নবিজির কন্যাদের মধ্যে সর্বশ্রেষ্ঠ কে?", options: ["যাইনাব (রা.)", "ফাতিমা (রা.)", "রুকাইয়া (রা.)", "উম্মু কুলসুম (রা.)"], correctIndex: 1, note: "উম্মতের ঐকমত্যে হযরত ফাতিমা (রা.) নবি (সা.)-এর কন্যাদের মধ্যে সর্বশ্রেষ্ঠ ছিলেন। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "হযরত ফাতিমা (রা.)-এর বিবাহের সময় মোহরানা কত নির্ধারণ করা হয়েছিল?", options: ["৪০০ দিরহাম", "৪৮০ দিরহাম", "৫০০ দিরহাম", "১০০০ দিরহাম"], correctIndex: 1, note: "মোহর নির্ধারিত ছিল ৪৮০ দিরহাম। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "নবিজি (সা.) হযরত ফাতিমাকে বিবাহের উপহার হিসেবে কী কী দিয়েছিলেন?", options: ["একটি চাদর", "দুটি স্বর্ণের কঙ্কন", "আটা পেষার জাঁতা", "খেজুর গাছের আঁশ-ভরা বালিশ"], correctIndices: [0, 2, 3], note: "উপহার হিসেবে দেন একটি চাদর, খেজুর গাছের আঁশ-ভরা একটি বালিশ, একটি চামড়ার গদি, একটি দড়ির খাট, দুটি মাটির পাত্র, দুটি পানির মশক এবং একটি আটা পেষার জাঁতা। সূত্র: পৃষ্ঠা ৩১।"},
                    {question: "নবিজির কোন কন্যা হিজরতের সময় মক্কা থেকে হাবশায় হিজরত করেছিলেন?", options: ["যাইনাব (রা.)", "ফাতিমা (রা.)", "রুকাইয়া (রা.)", "উম্মু কুলসুম (রা.)"], correctIndex: 2, note: "হযরত রুকাইয়া (রা.) স্বামী হযরত উসমান (রা.)-এর সঙ্গে মক্কা থেকে হাবশায় হিজরত করেছিলেন। সূত্র: পৃষ্ঠা ৩২।"},
                    {question: "হযরত উসমান (রা.)-কে 'যুন নুরাইন' বা 'দুই নূরের অধিকারী' বলা হয় কেন?", options: ["তিনি কুরআনের হাফেজ ছিলেন", "তিনি নবিজির দুইজন কন্যাকে বিবাহ করেছিলেন", "তিনি অনেক দান করতেন", "তিনি বদর ও ওহুদ যুদ্ধে অংশ নিয়েছিলেন"], correctIndex: 1, note: "৩য় হিজরিতে নবিজি উম্মু কুলসুমকে হযরত উসমানের সঙ্গে বিবাহ দেন (রুকাইয়ার মৃত্যুর পর)। এই কারণে হযরত উসমান 'যুন নুরাইন' উপাধি লাভ করেন। সূত্র: পৃষ্ঠা ৩২।"},
                    {question: "হযরত রুকাইয়া (রা.) কখন ইন্তেকাল করেন?", options: ["বদর যুদ্ধ থেকে ফেরার সময়", "ওহুদ যুদ্ধের সময়", "মক্কা বিজয়ের সময়", "বিদায় হজ্জের সময়"], correctIndex: 0, note: "২য় হিজরিতে বদর যুদ্ধ থেকে নবি (সা.) ও সাহাবায়ে কেরামের ফেরার সময় রুকাইয়া (রা.) নিঃসন্তান অবস্থায় ইন্তেকাল করেন। সূত্র: পৃষ্ঠা ৩২।"},
                    {question: "হযরত খাদিজা (রা.)-এর ইন্তেকালের কত বছর পর নবিজি (সা.) পুনরায় বিবাহ করেন?", options: ["১ বছর", "২ বছর", "৩ বছর", "৪ বছর"], correctIndex: 2, note: "হিজরতের তিন বছর পূর্বে খাদিজা (রা.) ইন্তেকাল করেন। এরপর ৪৯ বছর বয়সে (৩ বছর পর) নবিজি পুনরায় বিবাহ বন্ধনে আবদ্ধ হন। সূত্র: পৃষ্ঠা ৩২।"},
                    {question: "নবিজির স্ত্রীদের মধ্যে খাদিজা (রা.)-এর মৃত্যুর পর কে সর্বপ্রথম তাঁর স্ত্রী হন?", options: ["আয়িশা (রা.)", "সাওদা (রা.)", "হাফসা (রা.)", "যাইনাব (রা.)"], correctIndex: 1, note: "হযরত সাওদা (রা.) প্রথমে সাকরান ইবনু আমর-এর স্ত্রী ছিলেন। তার মৃত্যুর পর তিনি রাসুল (সা.)-এর সঙ্গে বিবাহ বন্ধনে আবদ্ধ হন (খাদিজার পর প্রথম)। সূত্র: পৃষ্ঠা ৩৩।"},
                    {question: "হযরত আয়িশা সিদ্দিকা (রা.)-এর সাথে নবিজির বিবাহের সময় তাঁর বয়স কত ছিল?", options: ["ছয় বছর", "নয় বছর", "বারো বছর", "পনেরো বছর"], correctIndex: 0, note: "ছয় বছর বয়সে তিনি নবি (সা.)-এর সাথে বিবাহ বন্ধনে আবদ্ধ হন। সূত্র: পৃষ্ঠা ৩৩।"},
                    {question: "হযরত আয়িশা (রা.) কত বছর বয়সে নবিজির ঘরে আসেন (বিদায় তুলে দেয়া হয়)?", options: ["ছয় বছর", "নয় বছর", "দশ বছর", "বারো বছর"], correctIndex: 1, note: "১ম হিজরিতে নয় বছর বয়সে তিনি নবি (সা.)-এর ঘরে আসেন। সূত্র: পৃষ্ঠা ৩৩।"},
                    {question: "নবিজির কোন স্ত্রী 'উম্মুল মাসাকিন' বা 'অসহায়দের জননী' নামে পরিচিত ছিলেন?", options: ["উম্মু সালামা (রা.)", "যাইনাব বিনতু খুযাইমা (রা.)", "যাইনাব বিনতু জাহশ (রা.)", "জুওয়াইরিয়া (রা.)"], correctIndex: 1, note: "হযরত যাইনাব বিনতু খুযাইমা (রা.) পরিচিত ছিলেন 'উম্মুল-মাসাকিন' (অসহায়দের জননী) নামে। সূত্র: পৃষ্ঠা ৩৩।"},
                    {question: "নবিজির জীবদ্দশায় তাঁর কতজন স্ত্রী ইন্তেকাল করেছিলেন?", options: ["১ জন", "২ জন", "৩ জন", "৪ জন"], correctIndex: 1, note: "১১ জন স্ত্রীর মধ্যে দুজন নবি (সা.)-এর জীবদ্দশায় ইন্তেকাল করেন (খাদিজা রা. ও যাইনাব বিনতু খুযাইমা রা.)। সূত্র: পৃষ্ঠা ৩৩ ও ৩৯।"},
                    {question: "হযরত উম্মু হাবিবা (রা.)-এর সাথে নবিজির বিবাহের আয়োজন কে করেছিলেন?", options: ["আবু সুফিয়ান", "বাদশাহ নাজাশি", "উসমান (রা.)", "আব্বাস (রা.)"], correctIndex: 1, note: "নাজাশি তখন প্রস্তাব পাঠান এবং নিজেই বিবাহের আয়োজন করেন। মোহর হিসেবে তিনিই ৪০০ দিনার আদায় করে দেন। সূত্র: পৃষ্ঠা ৩৪।"},
                    {question: "হযরত উম্মু সালামা (রা.)-এর আসল নাম কী ছিল?", options: ["রামলা", "হিন্দা", "বাররা", "ফাতেমা"], correctIndex: 1, note: "হযরত উম্মু সালামা (রা.)-এর নাম ছিল হিন্দা। সূত্র: পৃষ্ঠা ৩৪।"},
                    {question: "উম্মুল মুমিনিনদের মধ্যে সবার শেষে কে ইন্তেকাল করেছিলেন?", options: ["আয়িশা (রা.)", "উম্মু সালামা (রা.)", "মাইমুনা (রা.)", "সাফিয়া (রা.)"], correctIndex: 1, note: "তিনি (উম্মু সালামা) উম্মুল মুমিনীনদের মধ্যে সবার শেষে ইন্তেকাল করেছিলেন। সূত্র: পৃষ্ঠা ৩৪।"},
                    {question: "নবিজির কোন স্ত্রীর সাথে বিবাহের মাধ্যমে পালকপুত্র সম্পর্কিত জাহিলি কুসংস্কার দূর করা হয়?", options: ["জুওয়াইরিয়া (রা.)", "যাইনাব বিনতু জাহশ (রা.)", "সাফিয়া (রা.)", "উম্মু হাবিবা (রা.)"], correctIndex: 1, note: "পালকপুত্র কখনো আপন পুত্রের সমান নয়... এই হালাল বিষয়কে বিশ্বাস ও কাজের দিক দিয়ে প্রতিষ্ঠা করতে আল্লাহ এই বিবাহের (যাইনাব বিনতু জাহশ) নির্দেশ দেন। সূত্র: পৃষ্ঠা ৩৫।"},
                    {question: "হযরত যাইনাব বিনতু জাহশ (রা.) নবিজির কী আত্মীয় ছিলেন?", options: ["খালাতো বোন", "ফুফাতো বোন", "চাচাতো বোন", "মামাতো বোন"], correctIndex: 1, note: "তিনি ছিলেন নবিজির ফুফাতো বোন। সূত্র: পৃষ্ঠা ৩৪।"},
                    {question: "হযরত সাফিয়া (রা.) কোন নবির বংশধর ছিলেন?", options: ["হযরত মুসা (আ.)", "হযরত হারুন (আ.)", "হযরত দাউদ (আ.)", "হযরত সুলাইমান (আ.)"], correctIndex: 1, note: "হযরত হারুন (আ.)-এর বংশধর। এটা তাঁর অনন্য বৈশিষ্ট্য ছিল যে, তিনি একজন নবি-বংশের কন্যা এবং অপর একজন নবির স্ত্রী। সূত্র: পৃষ্ঠা ৩৫।"},
                    {question: "কোন স্ত্রীর সাথে নবিজির বিবাহের বরকতে তাঁর পুরো গোত্র (বনি মুস্তালিক) মুক্তি পেয়েছিল?", options: ["সাফিয়া (রা.)", "জুওয়াইরিয়া (রা.)", "মাইমুনা (রা.)", "উম্মু হাবিবা (রা.)"], correctIndex: 1, note: "হযরত জুওয়াইরিয়া বিনতু হারিস... এই বিবাহের বরকতে তাঁর পুরো গোত্র মুক্তি পায় এবং ইসলাম গ্রহণ করে। সূত্র: পৃষ্ঠা ৩৫।"},
                    {question: "নবিজির সর্বশেষ স্ত্রী কে ছিলেন (যার পরে তিনি আর বিবাহ করেননি)?", options: ["মাইমুনা বিনতু হারিস (রা.)", "সাফিয়া (রা.)", "জুওয়াইরিয়া (রা.)", "হাফসা (রা.)"], correctIndex: 0, note: "হযরত মাইমুনা বিনতু হারিস... তিনি নবি (সা.)-এর সর্বশেষ স্ত্রী ছিলেন। তাঁর পর নবি আর কোনো বিবাহ করেননি। সূত্র: পৃষ্ঠা ৩৫-৩৬।"},
                    {question: "কোন বিখ্যাত খ্রিস্টান পণ্ডিত বহুবিবাহের সমর্থনে 'লাইফ' গ্রন্থে বক্তব্য রেখেছেন?", options: ["মি. ডেভনপোর্ট", "মাইকেল এইচ হার্ট", "টমাস কার্লাইল", "জর্জ বার্নার্ড শ"], correctIndex: 0, note: "মিস্টার ডেভনপোর্ট নামে একজন বিখ্যাত খ্রিস্টান পণ্ডিত, বহুবিবাহের সমর্থনে... লিখেছেন। সূত্র: পৃষ্ঠা ৩৬।"},
                    {question: "ইসলামে একজন পুরুষের জন্য সর্বোচ্চ কতজন স্ত্রী রাখার অনুমতি দেওয়া হয়েছে (শর্তসাপেক্ষে)?", options: ["দুইজন", "তিনজন", "চারজন", "অসীম"], correctIndex: 2, note: "একজন পুরুষ একসঙ্গে চারজন পর্যন্ত স্ত্রী রাখতে পারবে, তবে শর্ত হলো—তাদের সকলের প্রতি সমান অধিকার ও ন্যায়বিচার নিশ্চিত করতে হবে। সূত্র: পৃষ্ঠা ৩৭।"},
                    {question: "নবিজির সাহাবি হযরত গাইলান (রা.) ইসলাম গ্রহণের সময় তাঁর কতজন স্ত্রী ছিলেন?", options: ["৫ জন", "৮ জন", "১০ জন", "১২ জন"], correctIndex: 2, note: "হযরত গাইলান (রা.) ইসলাম গ্রহণের সময় তাঁর দশজন স্ত্রী ছিলেন। রাসুল (সা.) তাঁকে নির্দেশ দেন চারজন রেখে বাকিদের তালাক দিতে। সূত্র: পৃষ্ঠা ৩৭।"},
                    {question: "কুরআনের কোন আয়াতে নবিজির স্ত্রীদের 'মুমিনদের মা' হিসেবে ঘোষণা করা হয়েছে?", options: ["সুরা আহযাব: ৬", "সুরা আহযাব: ৫৩", "সুরা নিসা: ৩", "সুরা নূর: ২৬"], correctIndex: 0, note: "রাসুল (সা.)-এর স্ত্রীগণ হলেন সমগ্র উম্মতের মা (উম্মাহাতুল মুমিনীন)। ব্যাখ্যায় সুরা আহযাব ৬ নং আয়াতের মর্মার্থ উল্লেখ করা হয়েছে। সূত্র: পৃষ্ঠা ৩৮।"},
                    {question: "নবিজির (সা.) স্ত্রীদের ক্ষেত্রে কোনটি সাধারণ নারীদের চেয়ে ভিন্ন বিধান ছিল?", options: ["তাঁদের পর্দা করতে হতো না", "নবিজির মৃত্যুর পর তাঁরা আর কারও সঙ্গে বিবাহ বন্ধনে আবদ্ধ হতে পারতেন না", "তাঁদের কোনো মপহরানা ছিল না", "তাঁরা যুদ্ধে যেতে পারতেন না"], correctIndex: 1, note: "তাঁর মৃত্যুর পর তাঁরা আর কারও সঙ্গে বিবাহ বন্ধনে আবদ্ধ হতে পারবেন না। যদি এই সাধারণ নিয়ম (৪ জনের নিয়ম ও তালাক) তাঁদের ওপর আরোপ করা হতো... তবে এটি বড় অবিচার হতো। সূত্র: পৃষ্ঠা ৩৮।"},
                    {question: "নবিজি (সা.) তাঁর যৌবনের অধিকাংশ সময় (৫০ বছর বয়স পর্যন্ত) কীভাবে অতিবাহিত করেছেন?", options: ["একাধিক স্ত্রীর সাথে", "একজন বয়স্ক বিধবা নারীর (খাদিজা) সাথে", "চিরকুমার হিসেবে", "যুদ্ধবিগ্রহে"], correctIndex: 1, note: "তিনি যৌবনের লম্বা সময় একজন বয়স্ক নারীর সঙ্গে কাটিয়ে দিয়েছেন। ... ২৫ বছর বয়সে হযরত খাদিজা (রা.)... তিনি তখন ৪০ বছর বয়সে উপনীত। সূত্র: পৃষ্ঠা ৩৯।"},
                    {question: "ইন্তেকালের সময় নবিজির পবিত্র স্ত্রীগণের সংখ্যা কত ছিল?", options: ["৭ জন", "৯ জন", "১১ জন", "১৩ জন"], correctIndex: 1, note: "নবিজি (সা.) ইন্তেকালের সময় তাঁর পবিত্র স্ত্রীগণের সংখ্যা ছিল ৯ জন। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "নবিজির ইন্তেকালের পর তাঁর স্ত্রীদের মধ্যে সর্বপ্রথম কে ইন্তেকাল করেন?", options: ["যাইনাব বিনতু জাহশ (রা.)", "সাফিয়া (রা.)", "আয়িশা (রা.)", "উম্মু সালামা (রা.)"], correctIndex: 0, note: "তাঁদের মধ্যে সর্বপ্রথম ইন্তেকাল করেন হযরত যাইনাব বিনতু জাহশ (রা.)। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "নবিজির দাদা আব্দুল মুত্তালিবের পুত্র (নবিজির চাচা) কতজন ছিলেন?", options: ["৮ জন", "১০ জন", "১২ জন", "১৪ জন"], correctIndex: 1, note: "নবি (সা.)-এর দাদা আব্দুল মুত্তালিবের পুত্র ছিলেন দশজন। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "নিচের কোন ব্যক্তিরা নবিজির চাচা ছিলেন?", options: ["হারিস", "আবু লাহাব", "হামযাহ", "উপরে সবকটি"], correctIndices: [0, 1, 2, 3], note: "তাঁরা হলেন হারিস, যুবাইর, হাজাল, যিরার, মুকাওয়িম, আবু লাহাব, আব্বাস, হামযাহ, আবু তালিব ও আব্দুল্লাহ। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "নবিজির ফুফুদের সংখ্যা কতজন ছিল?", options: ["৪ জন", "৫ জন", "৬ জন", "৭ জন"], correctIndex: 2, note: "নবিজি (সা.)-এর ছয়জন ফুফু ছিলেন। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "বদর যুদ্ধে নবিজির নিরাপত্তার দায়িত্ব কে পালন করেছিলেন?", options: ["সাদ ইবনু মুআয (রা.)", "মুহাম্মাদ ইবনু মাসলামা (রা.)", "বিলাল (রা.)", "যুবাইর (রা.)"], correctIndex: 0, note: "সাদ ইবনু মুআয (রা.) বদর যুদ্ধে রাসুল (সা.)-এর নিরাপত্তার দায়িত্ব পালন করেন। সূত্র: পৃষ্ঠা ৪০।"},
                    {question: "আল্লাহ তায়ালা কোন আয়াত নাযিল করার পর নবিজি (সা.) তাঁর দেহরক্ষীদের বিদায় করে দেন?", options: ["ওয়াল্লাহু ইয়া'সিমুকা মিনান-নাস", "ইন্নাকা লা তাহদি মান আহবাবতা", "ওয়ামা আরসালনাকা ইল্লা রাহমাতাল্লিল আলামিন", "ইয়া আইয়্যুহার রাসুলু বাল্লিগ মা উনযিলা ইলাইকা"], correctIndex: 0, note: "যখন এই আয়াত নাযিল হয়: 'ওয়াল্লাহু ইয়া'সিমুকা মিনান-নাস' (আর আপনাকে মানুষের অনিষ্ট থেকে আল্লাহ তায়ালাই রক্ষা করবেন), তখন রাসুল (সা.) তাঁর এই পাহারাদারি... বাদ দিয়ে দেন। সূত্র: পৃষ্ঠা ৪১।"},
                    {question: "নবিজির ৩৫ বছর বয়সে কুরাইশরা কোন ঐতিহাসিক কাজটি করেছিল?", options: ["হিলফুল ফুজুল গঠন", "কাবাঘর পুনঃনির্মাণ", "দারুন নাদওয়া প্রতিষ্ঠা", "জমজম কূপ খনন"], correctIndex: 1, note: "যখন নবি (সা.)-এর বয়স পঁয়ত্রিশ বছর হলো, কুরাইশরা তখন কাবাঘর সম্পূর্ণরূপে পুনর্নির্মাণের সিদ্ধান্ত নেয়। সূত্র: পৃষ্ঠা ৪১।"},
                    {question: "কাবাঘর নির্মাণের সময় কোন বস্তুটি স্থাপন নিয়ে গোত্রগুলোর মধ্যে বিরোধ সৃষ্টি হয়েছিল?", options: ["মাকামে ইবরাহিম", "হাজরে আসওয়াদ", "মিজাবে রহমত", "কাবার দরজা"], correctIndex: 1, note: "কিন্তু হাজরে আসওয়াদ (কালো পাথর) উঠিয়ে নিয়ে নির্দিষ্ট স্থানে স্থাপন করার ক্ষেত্রেই চরম মতবিরোধের সৃষ্টি হয়। সূত্র: পৃষ্ঠা ৪১।"},
                    {question: "হাজরে আসওয়াদ বিরোধ নিষ্পত্তিতে নবিজি (সা.) কী ব্যবহার করেছিলেন?", options: ["একটি তলোয়ার", "একটি চাদর", "একটি লাঠি", "একটি উট"], correctIndex: 1, note: "তিনি একটি চাদর বিছিয়ে নিজ হাতে হাজরে আসওয়াদ তুলে সেটির ওপর রাখলেন। সূত্র: পৃষ্ঠা ৪২।"},
                    {question: "আনুষ্ঠানিকভাবে নবুয়ত লাভের সময় নবিজির বয়স কত ছিল?", options: ["৩৫ বছর", "৩৮ বছর", "৪০ বছর", "৪০ বছর ৬ মাস"], correctIndex: 2, note: "নবি (সা.)-এর বয়স চল্লিশ বছর এক দিন পূর্ণ হলো। তখন তাঁকে... নবুয়তের বিশেষ সম্মান... প্রদান করা হলো। সূত্র: পৃষ্ঠা ৪২।"},
                    {question: "নবিজি কোন মাসে নবুয়ত লাভ করেছিলেন বলে বইতে উল্লেখ আছে?", options: ["রমজান", "রবিউল আউয়াল", "রজব", "মুহাররম"], correctIndex: 1, note: "জন্ম-তারিখের মতো নবুয়ত লাভের তারিখও ছিল রবিউল আউয়াল মাসের কোনো-এক সোমবার। সূত্র: পৃষ্ঠা ৪২।"},
                    {question: "নবুয়ত লাভের পর ইসলাম প্রচারের প্রথম পর্যায়টি কেমন ছিল?", options: ["প্রকাশ্য জনসভা", "গোপন প্রচার", "বাদশাহদের কাছে চিঠি প্রেরণ", "যুদ্ধের মাধ্যমে"], correctIndex: 1, note: "তাই আল্লাহর হিকমত অনুযায়ী, শুরুতে ইসলাম প্রচার গোপনে করা হয়, যেন মানুষ দূরে সরে না যায়। সূত্র: পৃষ্ঠা ৪২।"}
                ]
            }
        ];

        // --- CONSTANTS ---
        const latestLectureWithSyllabus = [...COURSE_DATA].reverse().find(l => l.content.syllabus);
        const GLOBAL_NOTICE = latestLectureWithSyllabus ? latestLectureWithSyllabus.content.syllabus : "আসসালামু আলাইকুম।";

        const TEXTS = {
            siteTitle: "মাসউদ আলিমী",
            subtitle: "কুরআন তাফসির ও সীরাত কোর্স",
            home: "হোম",
            searchPlaceholder: "ক্লাস খুঁজুন...",
            listen: "শুনুন",
            download: "ডাউনলোড",
            summary: "সারসংক্ষেপ",
            resources: "রিসোর্স ও নোট",
            syllabus: "পরবর্তী ক্লাসের প্রস্তুতি ও সিলেবাস",
            back: "ফিরে যান",
            playOnDrive: "ড্রাইভে প্লে করুন",
            footerText: "সর্বস্বত্ব সংরক্ষিত © ২০২৬ | মাসউদ আলিমী",
            tafsir: "তাফসির",
            seerat: "সীরাত",
            all: "সব",
            noResults: "কোনো ক্লাস খুঁজে পাওয়া যায়নি।",
            takeQuiz: "কুইজ টেস্ট দিন",
            quizTitle: "আপনার জ্ঞান যাচাই করুন",
            quizDesc: "এই ক্লাসের উপর ভিত্তি করে কুইজ টেস্ট দিন এবং নিজেকে যাচাই করুন।",
            startQuiz: "কুইজ শুরু করুন",
            question: "প্রশ্ন",
            next: "পরবর্তী",
            finish: "ফলাফল দেখুন",
            yourScore: "আপনার স্কোর",
            totalQuestions: "মোট প্রশ্ন",
            retry: "আবার চেষ্টা করুন",
            backToLecture: "ক্লাসে ফিরে যান",
            correct: "সঠিক উত্তর!",
            wrong: "ভুল উত্তর!",
            correctAnswerIs: "সঠিক উত্তরটি হলো:"
        };

        const state = {
            darkMode: false,
            view: 'home',
            selectedLecture: null,
            filter: 'seerat',
            search: '',
            playerMode: 'embed',
            playbackRate: 1.0,
            quiz: { active: false, currentQuestion: 0, score: 0, selectedOption: null, selectedOptions: [], isAnswerChecked: false, isFinished: false, questions: [] }
        };

        // --- UTILITIES ---
        const getDriveEmbedLink = (url) => {
            if (typeof url !== 'string') return url;
            const parts = url.split("/d/");
            if (parts.length > 1) {
                const id = parts[1].split('/')[0];
                return `https://drive.google.com/file/d/${id}/preview`;
            }
            return url;
        };

        const MosqueIcon = () => `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4"/><path d="M10 6h4"/><path d="M12 6c3.5 0 6 3 6 7h-12c0-4 2.5-7 6-7Z"/><path d="M18 13v8"/><path d="M6 13v8"/><path d="M6 21h12"/><path d="M10 21v-4a2 2 0 0 1 4 0v4"/></svg>`;

        // --- RENDER FUNCTIONS ---
        const app = document.getElementById('app');
        const body = document.body;

        function render() {
            if (state.darkMode) {
                document.documentElement.classList.add('dark');
                body.classList.remove('bg-stone-50', 'text-stone-800');
                body.classList.add('bg-slate-900', 'text-slate-100');
            } else {
                document.documentElement.classList.remove('dark');
                body.classList.remove('bg-slate-900', 'text-slate-100');
                body.classList.add('bg-stone-50', 'text-stone-800');
            }

            let html = '';
            
            if (state.view !== 'quiz') {
                html += `<div class="sticky top-0 z-50 w-full flex flex-col">`;
                html += renderHeader();
                if (state.view === 'home') html += renderNoticeBar();
                html += `</div>`;
            }

            if (state.view === 'home') {
                html += renderHome();
                html += renderFooter();
            } else if (state.view === 'detail') {
                html += renderDetail();
                html += renderFooter();
            } else if (state.view === 'quiz') {
                html += renderQuiz();
            }

            app.innerHTML = html;
            lucide.createIcons();
            
            if(state.view === 'home') {
                const searchInput = document.getElementById('searchInput');
                if(searchInput) {
                    searchInput.value = state.search;
                    if(document.activeElement?.id === 'searchInput') searchInput.focus();
                }
            }
        }

        function renderHeader() {
            const bgClass = state.darkMode ? 'bg-slate-900/90 border-slate-700' : 'bg-white/90 border-stone-200';
            const iconBg = state.darkMode ? 'bg-emerald-600' : 'bg-emerald-500';
            const textClass = state.darkMode ? 'text-emerald-400' : 'text-emerald-700';

            return `
            <header class="shadow-md backdrop-blur-md border-b ${bgClass}">
                <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                    <div class="flex items-center gap-3 cursor-pointer" onclick="actions.goHome()">
                        <div class="p-2 rounded-lg ${iconBg} text-white">${MosqueIcon()}</div>
                        <div>
                            <h1 class="text-lg md:text-xl font-bold leading-tight ${textClass}">${TEXTS.siteTitle}</h1>
                            <p class="text-xs opacity-70 hidden sm:block">${TEXTS.subtitle}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 md:gap-3">
                        <button onclick="actions.toggleTheme()" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition">
                            <i data-lucide="${state.darkMode ? 'sun' : 'moon'}" class="${state.darkMode ? 'text-amber-400' : 'text-slate-600'} w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </header>
            `;
        }

        function renderNoticeBar() {
            const colors = state.darkMode ? 'bg-emerald-900 text-emerald-100 border-emerald-800' : 'bg-emerald-600 text-white border-emerald-700';
            return `<div class="w-full overflow-hidden py-3 shadow-md relative z-10 border-b ${colors}"><div class="animate-marquee flex items-center"><div class="flex items-center shrink-0 px-8"><span class="font-extrabold flex items-center gap-2 px-2"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span><span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span></div><div class="flex items-center shrink-0 px-8"><span class="font-extrabold flex items-center gap-2 px-2"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span><span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span></div><div class="flex items-center shrink-0 px-8"><span class="font-extrabold flex items-center gap-2 px-2"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span><span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span></div></div></div>`;
        }

        function renderHome() {
            const heroBg = state.darkMode ? 'bg-gradient-to-br from-slate-800 to-slate-900 border-slate-700' : 'bg-gradient-to-br from-white to-emerald-50 border-emerald-100 shadow-sm';
            const heroText = state.darkMode ? 'text-emerald-100' : 'text-emerald-900';
            const barBg = state.darkMode ? 'bg-emerald-500' : 'bg-emerald-600';
            
            const filtered = COURSE_DATA.filter(l => {
                const matchesSearch = l.content.title.toLowerCase().includes(state.search.toLowerCase()) || 
                                      l.content.description.toLowerCase().includes(state.search.toLowerCase());
                const matchesCategory = state.filter === 'all' || l.category === state.filter;
                return matchesSearch && matchesCategory;
            });

            return `
            <main class="container mx-auto px-4 py-6 md:py-10 min-h-[calc(100vh-140px)] animate-fade-in">
                
                <div class="rounded-2xl p-6 md:p-10 text-center space-y-4 border mb-8 ${heroBg} shadow-soft">
                    <div class="flex justify-center mb-2">
                        <div class="h-1 w-20 rounded-full ${barBg}"></div>
                    </div>
                    <h2 class="text-2xl md:text-4xl font-bold ${heroText}">${TEXTS.subtitle}</h2>
                    <p class="max-w-2xl mx-auto opacity-80 leading-relaxed font-medium">
                        কুরআনের গভীর জ্ঞান এবং রাসূল (সা.) এর জীবনের শিক্ষণীয় ঘটনাবলী জানতে আমাদের এই আয়োজন। নিচে সকল ক্লাসের তালিকা দেয়া হলো।
                    </p>
                </div>

                <div class="flex flex-col md:flex-row gap-4 justify-between items-center sticky top-20 z-30 py-2 mb-8">
                    <div class="flex gap-2 overflow-x-auto w-full md:w-auto pb-2 md:pb-0 hide-scrollbar">
                        ${['all', 'tafsir', 'seerat'].map(cat => {
                            const isActive = state.filter === cat;
                            const activeClass = state.darkMode ? 'bg-emerald-600 text-white' : 'bg-emerald-600 text-white shadow-glow';
                            const inactiveClass = state.darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-white hover:bg-stone-100 border border-stone-200';
                            return `<button onclick="actions.setFilter('${cat}')" class="px-5 py-2 rounded-full text-sm font-semibold whitespace-nowrap transition-all duration-300 ${isActive ? activeClass : inactiveClass}">${cat === 'all' ? TEXTS.all : TEXTS[cat]}</button>`
                        }).join('')}
                    </div>
                    <div class="relative w-full md:w-64">
                        <input id="searchInput" type="text" placeholder="${TEXTS.searchPlaceholder}" 
                            class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all shadow-sm ${state.darkMode ? 'bg-slate-800 border-slate-700 placeholder-slate-500 text-white' : 'bg-white placeholder-stone-400'}"
                            oninput="actions.setSearch(this.value)"
                            value="${state.search}"
                        >
                        <i data-lucide="search" class="absolute left-3 top-2.5 opacity-50 w-4 h-4"></i>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${filtered.length > 0 ? filtered.map(lecture => renderLectureCard(lecture)).join('') : renderEmptyState()}
                </div>
            </main>
            `;
        }

        function renderLectureCard(lecture) {
            const cardBg = state.darkMode ? 'bg-slate-800 border-slate-700 hover:border-emerald-500/50' : 'bg-white border-stone-200 hover:border-emerald-300';
            const catColor = lecture.category === 'tafsir' ? 'bg-emerald-500' : 'bg-amber-500';
            const badgeBg = state.darkMode ? 'bg-slate-700 text-slate-300' : 'bg-stone-100 text-stone-600';
            const titleColor = state.darkMode ? 'text-slate-100' : 'text-slate-800';

            return `
            <div onclick="actions.selectLecture(${lecture.id})" class="group cursor-pointer rounded-xl overflow-hidden border transition-all duration-300 hover:shadow-xl hover:-translate-y-1 ${cardBg}">
                <div class="h-2 w-full ${catColor}"></div>
                <div class="p-6 space-y-4">
                    <div class="flex justify-between items-start">
                        <span class="text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider ${badgeBg}">${TEXTS[lecture.category]}</span>
                        <div class="flex items-center gap-1 text-xs opacity-60 font-medium">
                            <i data-lucide="calendar" class="w-3 h-3"></i> <span>${lecture.date}</span>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold leading-tight group-hover:text-emerald-500 transition-colors ${titleColor}">${lecture.content.title}</h3>
                    <p class="text-sm opacity-70 line-clamp-2 leading-relaxed">${lecture.content.description}</p>
                    <div class="pt-4 flex items-center justify-between border-t border-dashed border-gray-500/30 opacity-80 mt-2">
                         <div class="flex items-center gap-1 text-xs font-medium">
                           <i data-lucide="clock" class="w-3 h-3"></i> <span>${lecture.duration}</span>
                         </div>
                         <div class="flex items-center gap-1 text-xs font-bold text-emerald-500 group-hover:translate-x-1 transition-transform">
                           ${TEXTS.listen} <i data-lucide="arrow-left" class="w-3 h-3 rotate-180"></i>
                         </div>
                    </div>
                </div>
            </div>
            `;
        }

        function renderEmptyState() {
            return `
            <div class="col-span-full text-center py-20 opacity-50">
                <div class="inline-block p-4 rounded-full bg-gray-100 dark:bg-slate-800 mb-2">
                    <i data-lucide="search" class="w-6 h-6"></i>
                </div>
                <p class="text-lg font-medium">${TEXTS.noResults}</p>
            </div>
            `;
        }

        function renderFooter() {
            return `
            <footer class="py-8 text-center text-sm opacity-60 border-t ${state.darkMode ? 'border-slate-800' : 'border-stone-200'}">
                <div class="container mx-auto px-4">
                    <p class="font-medium tracking-wide">${TEXTS.footerText}</p>
                </div>
            </footer>
            `;
        }

        function renderDetail() {
            const l = state.selectedLecture;
            const cardBg = state.darkMode ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-200';
            const titleColor = state.darkMode ? 'text-emerald-100' : 'text-emerald-900';
            const badgeClass = l.category === 'tafsir' 
                ? 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200' 
                : 'bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200';
            
            const playerBg = state.darkMode ? 'bg-slate-900' : 'bg-stone-50';

            const resourcesHTML = l.content.resources.length > 0 
                ? `<ul class="space-y-3">` + l.content.resources.map(res => `
                    <li><a href="${res.url}" class="flex items-center gap-3 text-sm p-4 rounded-xl transition-all duration-200 border border-transparent hover:shadow-md ${state.darkMode ? 'bg-slate-700 bg-opacity-50 hover:bg-slate-700 text-emerald-400' : 'bg-white hover:border-emerald-100 text-emerald-800 shadow-sm'}">
                        <div class="p-2 rounded-full bg-emerald-100 dark:bg-emerald-900/50"><i data-lucide="external-link" class="w-4 h-4"></i></div>
                        <span class="font-medium">${res.label}</span>
                    </a></li>
                  `).join('') + `</ul>`
                : `<p class="text-sm opacity-50 italic">কোনো নোট যুক্ত করা হয়নি</p>`;

            const hasQuiz = l.quiz && l.quiz.length > 0;
            const quizHTML = hasQuiz ? `
                <div class="bg-gradient-to-br from-emerald-600 to-emerald-800 rounded-2xl p-8 text-white text-center shadow-lg relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-500"><i data-lucide="help-circle" class="w-32 h-32"></i></div>
                    <div class="relative z-10">
                        <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                            <i data-lucide="brain-circuit" class="w-8 h-8 text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">
                             ${TEXTS.quizTitle}
                        </h3>
                        <p class="opacity-90 mb-8 text-sm max-w-md mx-auto leading-relaxed">${TEXTS.quizDesc}</p>
                        <button onclick="actions.startQuiz()" class="bg-white text-emerald-800 px-8 py-3.5 rounded-full font-bold hover:bg-emerald-50 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 inline-flex items-center gap-2">
                            <i data-lucide="play-circle" class="w-5 h-5"></i> ${TEXTS.takeQuiz}
                        </button>
                    </div>
                </div>
            ` : '';
            
            return `
            <main class="container mx-auto px-4 py-6 md:py-10 min-h-[calc(100vh-140px)] animate-fade-in">
                <div class="max-w-4xl mx-auto space-y-6">
                    <button onclick="actions.goHome()" class="flex items-center gap-2 text-sm font-bold hover:text-emerald-500 transition-colors ${state.darkMode ? 'text-slate-400' : 'text-slate-600'}">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i> ${TEXTS.back}
                    </button>

                    <div class="rounded-2xl p-6 md:p-8 border shadow-soft ${cardBg}">
                        
                        <!-- Header -->
                        <div class="mb-8 space-y-3">
                            <div class="flex flex-wrap gap-3 items-center mb-3">
                                <span class="text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider ${badgeClass}">${TEXTS[l.category]}</span>
                                <span class="text-xs opacity-60 flex items-center gap-1 font-medium"><i data-lucide="calendar" class="w-3 h-3"></i> ${l.date}</span>
                                <span class="text-xs opacity-60 flex items-center gap-1 font-medium"><i data-lucide="clock" class="w-3 h-3"></i> ${l.duration}</span>
                            </div>
                            <h1 class="text-2xl md:text-4xl font-bold ${titleColor} leading-tight">${l.content.title}</h1>
                            <p class="opacity-80 text-lg leading-relaxed">${l.content.description}</p>
                        </div>

                        <!-- Player Area -->
                        <div class="p-6 rounded-2xl mb-10 flex flex-col items-center justify-center gap-6 shadow-inner ${playerBg}">
                            <div class="w-full flex flex-col items-center text-center gap-4">
                                ${state.playerMode === 'embed' ? `
                                    <div class="w-full max-w-3xl bg-emerald-900 rounded-xl overflow-hidden shadow-2xl relative animate-fade-in ring-1 ring-emerald-900/50">
                                        <div class="p-2 text-center text-xs text-white text-opacity-80 bg-emerald-800 bg-opacity-80 backdrop-blur-sm flex items-center justify-center gap-2">
                                           <i data-lucide="info" class="w-3 h-3"></i> গুগল ড্রাইভের বড় ফাইলের ক্ষেত্রে "Virus Scan Warning" দেখানো স্বাভাবিক।
                                        </div>
                                        <iframe src="${getDriveEmbedLink(l.driveLink)}" class="w-full h-[120px] border-0" allow="autoplay" loading="lazy" title="Audio Player"></iframe>
                                    </div>
                                ` : ''}
                                <div class="flex flex-col items-center gap-3 w-full max-w-md">
                                    <a href="${l.driveLink}" target="_blank" class="w-full flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-3 rounded-xl font-bold transition-all shadow-lg shadow-emerald-500/20 hover:shadow-emerald-500/40 active:scale-95">
                                        <i data-lucide="download" class="w-5 h-5"></i> ${TEXTS.playOnDrive} / ${TEXTS.download}
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Syllabus -->
                        ${l.content.syllabus ? `
                        <div class="p-6 rounded-2xl border-l-4 shadow-sm mb-10 ${state.darkMode ? 'bg-indigo-900/20 border-indigo-500 text-indigo-100' : 'bg-indigo-50 border-indigo-500 text-indigo-900'}">
                            <div class="flex items-start gap-4">
                                <div class="p-2 bg-indigo-100 dark:bg-indigo-900 rounded-lg shrink-0">
                                    <i data-lucide="book-marked" class="w-6 h-6 text-indigo-600 dark:text-indigo-400"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-lg mb-2">${TEXTS.syllabus}</h3>
                                    <p class="leading-relaxed opacity-90 font-medium">${l.content.syllabus}</p>
                                </div>
                            </div>
                        </div>
                        ` : ''}

                        <!-- Content Grid: Quiz Button & Resources -->
                        <div class="grid md:grid-cols-3 gap-8">
                            <div class="md:col-span-2 space-y-6">
                                ${hasQuiz ? quizHTML : '<div class="p-8 rounded-2xl bg-gray-50 dark:bg-slate-800 border border-dashed border-gray-200 dark:border-gray-700 text-center"><i data-lucide="file-question" class="w-10 h-10 mx-auto mb-3 text-gray-400"></i><p class="text-gray-500 font-medium">এই ক্লাসের জন্য কোনো কুইজ নেই।</p></div>'}
                            </div>
                            <div class="space-y-4">
                                <h3 class="text-lg font-bold flex items-center gap-2 pb-3 border-b border-gray-100 dark:border-gray-700 opacity-80">
                                    <i data-lucide="folder-open" class="w-5 h-5 text-emerald-500"></i> ${TEXTS.resources}
                                </h3>
                                ${resourcesHTML}
                            </div>
                        </div>

                    </div>
                </div>
            </main>
            `;
        }

        // --- UPDATED RENDER QUIZ (No more complex IIFE in template) ---
        function renderQuiz() {
            const qState = state.quiz;
            const quizData = qState.questions; 
            const currentQ = quizData[qState.currentQuestion];
            const isMultiple = currentQ.correctIndices && currentQ.correctIndices.length > 0;

            const bgClass = state.darkMode ? 'bg-slate-900 text-white' : 'bg-stone-50 text-stone-900';
            const cardBg = state.darkMode ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-200';
            
            // Result Screen
            if (qState.isFinished) {
                const percentage = Math.round((qState.score / quizData.length) * 100);
                let message = "", icon = "";
                if (percentage >= 80) { message = "মাশাআল্লাহ! দুর্দান্ত হয়েছে।"; icon = "trophy"; }
                else if (percentage >= 50) { message = "ভালো হয়েছে, তবে আরও ভালো করা সম্ভব।"; icon = "thumbs-up"; }
                else { message = "দুঃখিত! আরও মনোযোগ দিয়ে ক্লাসটি করুন।"; icon = "book-open"; }

                return `
                <div class="min-h-screen flex items-center justify-center p-4 animate-fade-in ${bgClass}">
                    <div class="max-w-md w-full rounded-3xl shadow-2xl overflow-hidden ${cardBg} border p-10 text-center relative">
                        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-emerald-400 to-cyan-500"></div>
                        <div class="w-24 h-24 rounded-full bg-emerald-50 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400 flex items-center justify-center mx-auto mb-6 shadow-sm">
                            <i data-lucide="${icon}" class="w-12 h-12"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2 opacity-60 uppercase tracking-wide">${TEXTS.yourScore}</h2>
                        <div class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-emerald-500 to-cyan-600 mb-4">${qState.score} <span class="text-3xl text-gray-400 font-medium">/ ${quizData.length}</span></div>
                        <p class="opacity-80 mb-10 text-lg font-medium">${message}</p>
                        
                        <div class="flex flex-col gap-3">
                            <button onclick="actions.retryQuiz()" class="w-full py-3.5 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold transition shadow-lg shadow-emerald-500/20">
                                ${TEXTS.retry}
                            </button>
                            <button onclick="actions.exitQuiz()" class="w-full py-3.5 rounded-xl border border-gray-200 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-slate-700/50 transition font-medium">
                                ${TEXTS.backToLecture}
                            </button>
                        </div>
                    </div>
                </div>
                `;
            }
            
            // Logic for Feedback Section
            let feedbackHTML = '';
            if (qState.isAnswerChecked) {
                const isCorrect = isMultiple 
                    ? (qState.selectedOptions.length === currentQ.correctIndices.length && qState.selectedOptions.every(val => currentQ.correctIndices.includes(val)))
                    : qState.selectedOption === currentQ.correctIndex;
                
                const feedbackContent = isCorrect
                    ? `<div class="p-6 rounded-2xl bg-emerald-50 border border-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-100 dark:border-emerald-800/50 mb-6 shadow-sm">
                         <div class="flex items-center gap-2 font-bold text-lg mb-2 text-emerald-600 dark:text-emerald-400"><i data-lucide="check-circle-2" class="w-5 h-5"></i> ${TEXTS.correct}</div>
                         ${currentQ.note ? `<div class="text-base leading-relaxed opacity-90">${currentQ.note}</div>` : ''}
                       </div>`
                    : `<div class="p-6 rounded-2xl bg-rose-50 border border-rose-100 text-rose-800 dark:bg-rose-900/30 dark:text-rose-100 dark:border-rose-800/50 mb-6 shadow-sm">
                         <div class="flex items-center gap-2 font-bold text-lg mb-2 text-rose-600 dark:text-rose-400"><i data-lucide="x-circle" class="w-5 h-5"></i> ${TEXTS.wrong}</div>
                         <div class="text-base font-bold mb-2">সঠিক উত্তর: ${
                             isMultiple 
                                ? currentQ.correctIndices.map(i => currentQ.options[i]).join(', ')
                                : currentQ.options[currentQ.correctIndex]
                         }</div>
                         ${currentQ.note ? `<div class="text-sm leading-relaxed opacity-90 border-t border-rose-200 dark:border-rose-800/50 pt-3 mt-2">${currentQ.note}</div>` : ''}
                       </div>`;

                feedbackHTML = `
                    <div class="mt-8 animate-pop">
                        ${feedbackContent}
                        <button onclick="actions.nextQuestion()" class="w-full py-4 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold text-lg shadow-xl shadow-emerald-500/30 hover:shadow-emerald-500/50 transition-all flex items-center justify-center gap-2 transform active:scale-95">
                            ${qState.currentQuestion < quizData.length - 1 ? TEXTS.next : TEXTS.finish} <i data-lucide="arrow-right" class="w-6 h-6"></i>
                        </button>
                    </div>
                `;
            }

            // Options HTML Construction
            const optionsHTML = currentQ.options.map((option, index) => {
                let optionClass = state.darkMode 
                    ? 'bg-slate-800 border-slate-700 hover:bg-slate-700' 
                    : 'bg-white border-stone-200 hover:border-emerald-200 hover:shadow-md';
                
                let icon = isMultiple ? '<div class="w-5 h-5 rounded border-2 border-gray-400"></div>' : '';

                if (qState.isAnswerChecked) {
                    const isCorrectOption = isMultiple 
                        ? currentQ.correctIndices.includes(index)
                        : index === currentQ.correctIndex;
                    
                    const isSelected = isMultiple
                        ? qState.selectedOptions.includes(index)
                        : index === qState.selectedOption;

                    if (isCorrectOption) {
                        optionClass = 'bg-emerald-50 border-emerald-500 text-emerald-800 dark:bg-emerald-900/40 dark:text-emerald-100 dark:border-emerald-500 ring-1 ring-emerald-500 shadow-md';
                        icon = '<div class="bg-emerald-500 text-white rounded-full p-1"><i data-lucide="check" class="w-4 h-4"></i></div>';
                    } else if (isSelected) {
                        optionClass = 'bg-rose-50 border-rose-500 text-rose-800 dark:bg-rose-900/40 dark:text-rose-100 dark:border-rose-500 ring-1 ring-rose-500';
                        icon = '<div class="bg-rose-500 text-white rounded-full p-1"><i data-lucide="x" class="w-4 h-4"></i></div>';
                    } else {
                        optionClass += ' opacity-50 cursor-not-allowed grayscale';
                    }
                } else {
                    const isSelected = isMultiple
                        ? qState.selectedOptions.includes(index)
                        : false; 
                    
                    if (isSelected) {
                        optionClass = 'bg-indigo-50 border-indigo-500 text-indigo-900 dark:bg-indigo-900/30 dark:border-indigo-500 dark:text-indigo-100 ring-1 ring-indigo-500';
                        icon = '<div class="bg-indigo-500 text-white rounded p-1"><i data-lucide="check" class="w-3 h-3"></i></div>';
                    }
                }

                return `
                <button 
                    onclick="${!qState.isAnswerChecked ? (isMultiple ? `actions.toggleOption(${index})` : `actions.checkAnswer(${index})`) : ''}"
                    class="w-full p-5 rounded-2xl border-2 text-left font-semibold text-lg transition-all duration-200 flex items-center justify-between group ${optionClass}"
                >
                    <span>${option}</span>
                    ${icon}
                </button>
                `;
            }).join('');

            return `
            <div class="min-h-screen flex flex-col ${bgClass} animate-fade-in">
                <!-- Quiz Header -->
                <div class="p-4 md:px-8 md:py-6 border-b ${state.darkMode ? 'border-slate-700 bg-slate-800' : 'border-stone-200 bg-white'} flex items-center justify-between sticky top-0 z-20">
                    <button onclick="actions.exitQuiz()" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-700 transition"><i data-lucide="x" class="w-6 h-6"></i></button>
                    <div class="font-bold text-lg flex items-center gap-2"><span class="text-emerald-500">প্রশ্ন</span> ${qState.currentQuestion + 1} <span class="opacity-40">/</span> ${quizData.length}</div>
                    <div class="w-10"></div> 
                </div>

                <!-- Progress Bar -->
                <div class="w-full h-1.5 bg-gray-100 dark:bg-slate-800">
                    <div class="h-full bg-gradient-to-r from-emerald-400 to-emerald-600 transition-all duration-500 ease-out" style="width: ${((qState.currentQuestion + 1) / quizData.length) * 100}%"></div>
                </div>

                <!-- Content -->
                <div class="flex-1 flex flex-col justify-center p-6 max-w-3xl mx-auto w-full">
                    <div class="text-xl md:text-3xl font-bold mb-4 text-center leading-relaxed">
                        ${currentQ.question}
                    </div>
                    
                    ${isMultiple ? `<div class="text-center text-sm text-emerald-500 font-bold mb-8 uppercase tracking-wide bg-emerald-100 dark:bg-emerald-900/50 py-1 px-3 rounded-full inline-block mx-auto">একাধিক উত্তর সঠিক হতে পারে</div>` : '<div class="mb-10"></div>'}

                    <div class="space-y-4">
                        ${optionsHTML}
                    </div>
                    
                    ${!qState.isAnswerChecked && isMultiple ? `
                        <div class="mt-8 animate-pop">
                            <button onclick="actions.submitAnswer()" class="w-full py-4 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-lg shadow-xl shadow-indigo-500/30 hover:shadow-indigo-500/50 transition-all flex items-center justify-center gap-2 transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed" ${qState.selectedOptions.length === 0 ? 'disabled' : ''}>
                                যাচাই করুন
                            </button>
                        </div>
                    ` : ''}

                    ${feedbackHTML}

                </div>
            </div>
            `;
        }

        // --- UPDATED ACTIONS ---
        const actions = {
            toggleTheme: () => { state.darkMode = !state.darkMode; render(); },
            goHome: () => { state.view = 'home'; state.selectedLecture = null; render(); },
            setFilter: (cat) => { state.filter = cat; render(); },
            setSearch: (val) => { state.search = val; if(state.view === 'home') render(); },
            selectLecture: (id) => { state.selectedLecture = COURSE_DATA.find(l => l.id === id); state.view = 'detail'; state.playbackRate = 1.0; window.scrollTo(0,0); render(); },
            
            // QUIZ ACTIONS
            startQuiz: () => { 
                const questions = [...state.selectedLecture.quiz];
                for (let i = questions.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [questions[i], questions[j]] = [questions[j], questions[i]]; }
                state.quiz = { active: true, currentQuestion: 0, score: 0, selectedOption: null, selectedOptions: [], isAnswerChecked: false, isFinished: false, questions: questions };
                state.view = 'quiz'; render(); 
            },
            
            // Single Choice Check
            checkAnswer: (idx) => { 
                state.quiz.selectedOption = idx; 
                state.quiz.isAnswerChecked = true; 
                if(idx === state.quiz.questions[state.quiz.currentQuestion].correctIndex) state.quiz.score++; 
                render(); 
            },
            
            // Multiple Choice Toggle
            toggleOption: (idx) => {
                const selected = state.quiz.selectedOptions;
                if (selected.includes(idx)) {
                    state.quiz.selectedOptions = selected.filter(i => i !== idx);
                } else {
                    state.quiz.selectedOptions.push(idx);
                }
                render();
            },
            
            // Multiple Choice Submit
            submitAnswer: () => {
                state.quiz.isAnswerChecked = true;
                const currentQ = state.quiz.questions[state.quiz.currentQuestion];
                const selected = state.quiz.selectedOptions.sort((a,b) => a-b).toString();
                const correct = currentQ.correctIndices.sort((a,b) => a-b).toString();
                
                if (selected === correct) {
                    state.quiz.score++;
                }
                render();
            },

            nextQuestion: () => { 
                if (state.quiz.currentQuestion < state.quiz.questions.length - 1) { 
                    state.quiz.currentQuestion++; 
                    state.quiz.selectedOption = null; 
                    state.quiz.selectedOptions = [];
                    state.quiz.isAnswerChecked = false; 
                } else { 
                    state.quiz.isFinished = true; 
                } 
                render(); 
            },
            retryQuiz: () => actions.startQuiz(),
            exitQuiz: () => { state.view = 'detail'; render(); }
        };

        function attachListeners() {
            // No global listeners needed
        }

        // Initialize
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            state.darkMode = true;
        }
        render();

    </script>
</body>
</html>
